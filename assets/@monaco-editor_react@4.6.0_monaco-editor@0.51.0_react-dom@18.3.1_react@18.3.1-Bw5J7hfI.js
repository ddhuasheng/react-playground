import{l as Y}from"./@monaco-editor_loader@1.4.0_monaco-editor@0.51.0-UJ2oDQtS.js";import{r as t,W as y}from"./react@18.3.1-C7uJT17l.js";var T={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},X=T,ee={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},te=ee;function re({children:r}){return y.createElement("div",{style:te.container},r)}var ne=re,ue=ne;function ie({width:r,height:o,isEditorReady:l,loading:u,_ref:p,className:h,wrapperProps:w}){return y.createElement("section",{style:{...X.wrapper,width:r,height:o},...w},!l&&y.createElement(ue,null,u),y.createElement("div",{ref:p,style:{...X.fullWidth,...!l&&X.hide},className:h}))}var oe=ie,Z=t.memo(oe);function ce(r){t.useEffect(r,[])}var $=ce;function ae(r,o,l=!0){let u=t.useRef(!0);t.useEffect(u.current||!l?()=>{u.current=!1}:r,o)}var m=ae;function W(){}function x(r,o,l,u){return le(r,u)||de(r,o,l,u)}function le(r,o){return r.editor.getModel(q(r,o))}function de(r,o,l,u){return r.editor.createModel(o,l,u?q(r,u):void 0)}function q(r,o){return r.Uri.parse(o)}function se({original:r,modified:o,language:l,originalLanguage:u,modifiedLanguage:p,originalModelPath:h,modifiedModelPath:w,keepCurrentOriginalModel:L=!1,keepCurrentModifiedModel:H=!1,theme:R="light",loading:_="Loading...",options:E={},height:j="100%",width:A="100%",className:B,wrapperProps:G={},beforeMount:J=W,onMount:Q=W}){let[M,b]=t.useState(!1),[C,s]=t.useState(!0),f=t.useRef(null),d=t.useRef(null),P=t.useRef(null),g=t.useRef(Q),i=t.useRef(J),S=t.useRef(!1);$(()=>{let e=Y.init();return e.then(c=>(d.current=c)&&s(!1)).catch(c=>(c==null?void 0:c.type)!=="cancelation"&&console.error("Monaco initialization: error:",c)),()=>f.current?N():e.cancel()}),m(()=>{if(f.current&&d.current){let e=f.current.getOriginalEditor(),c=x(d.current,r||"",u||l||"text",h||"");c!==e.getModel()&&e.setModel(c)}},[h],M),m(()=>{if(f.current&&d.current){let e=f.current.getModifiedEditor(),c=x(d.current,o||"",p||l||"text",w||"");c!==e.getModel()&&e.setModel(c)}},[w],M),m(()=>{let e=f.current.getModifiedEditor();e.getOption(d.current.editor.EditorOption.readOnly)?e.setValue(o||""):o!==e.getValue()&&(e.executeEdits("",[{range:e.getModel().getFullModelRange(),text:o||"",forceMoveMarkers:!0}]),e.pushUndoStop())},[o],M),m(()=>{var e,c;(c=(e=f.current)==null?void 0:e.getModel())==null||c.original.setValue(r||"")},[r],M),m(()=>{let{original:e,modified:c}=f.current.getModel();d.current.editor.setModelLanguage(e,u||l||"text"),d.current.editor.setModelLanguage(c,p||l||"text")},[l,u,p],M),m(()=>{var e;(e=d.current)==null||e.editor.setTheme(R)},[R],M),m(()=>{var e;(e=f.current)==null||e.updateOptions(E)},[E],M);let I=t.useCallback(()=>{var V;if(!d.current)return;i.current(d.current);let e=x(d.current,r||"",u||l||"text",h||""),c=x(d.current,o||"",p||l||"text",w||"");(V=f.current)==null||V.setModel({original:e,modified:c})},[l,o,p,r,u,h,w]),z=t.useCallback(()=>{var e;!S.current&&P.current&&(f.current=d.current.editor.createDiffEditor(P.current,{automaticLayout:!0,...E}),I(),(e=d.current)==null||e.editor.setTheme(R),b(!0),S.current=!0)},[E,R,I]);t.useEffect(()=>{M&&g.current(f.current,d.current)},[M]),t.useEffect(()=>{!C&&!M&&z()},[C,M,z]);function N(){var c,V,k,D;let e=(c=f.current)==null?void 0:c.getModel();L||((V=e==null?void 0:e.original)==null||V.dispose()),H||((k=e==null?void 0:e.modified)==null||k.dispose()),(D=f.current)==null||D.dispose()}return y.createElement(Z,{width:A,height:j,isEditorReady:M,loading:_,_ref:P,className:B,wrapperProps:G})}var fe=se;t.memo(fe);function ge(r){let o=t.useRef();return t.useEffect(()=>{o.current=r},[r]),o.current}var pe=ge,F=new Map;function he({defaultValue:r,defaultLanguage:o,defaultPath:l,value:u,language:p,path:h,theme:w="light",line:L,loading:H="Loading...",options:R={},overrideServices:_={},saveViewState:E=!0,keepCurrentModel:j=!1,width:A="100%",height:B="100%",className:G,wrapperProps:J={},beforeMount:Q=W,onMount:M=W,onChange:b,onValidate:C=W}){let[s,f]=t.useState(!1),[d,P]=t.useState(!0),g=t.useRef(null),i=t.useRef(null),S=t.useRef(null),I=t.useRef(M),z=t.useRef(Q),N=t.useRef(),e=t.useRef(u),c=pe(h),V=t.useRef(!1),k=t.useRef(!1);$(()=>{let n=Y.init();return n.then(a=>(g.current=a)&&P(!1)).catch(a=>(a==null?void 0:a.type)!=="cancelation"&&console.error("Monaco initialization: error:",a)),()=>i.current?K():n.cancel()}),m(()=>{var a,v,U,O;let n=x(g.current,r||u||"",o||p||"",h||l||"");n!==((a=i.current)==null?void 0:a.getModel())&&(E&&F.set(c,(v=i.current)==null?void 0:v.saveViewState()),(U=i.current)==null||U.setModel(n),E&&((O=i.current)==null||O.restoreViewState(F.get(h))))},[h],s),m(()=>{var n;(n=i.current)==null||n.updateOptions(R)},[R],s),m(()=>{!i.current||u===void 0||(i.current.getOption(g.current.editor.EditorOption.readOnly)?i.current.setValue(u):u!==i.current.getValue()&&(k.current=!0,i.current.executeEdits("",[{range:i.current.getModel().getFullModelRange(),text:u,forceMoveMarkers:!0}]),i.current.pushUndoStop(),k.current=!1))},[u],s),m(()=>{var a,v;let n=(a=i.current)==null?void 0:a.getModel();n&&p&&((v=g.current)==null||v.editor.setModelLanguage(n,p))},[p],s),m(()=>{var n;L!==void 0&&((n=i.current)==null||n.revealLine(L))},[L],s),m(()=>{var n;(n=g.current)==null||n.editor.setTheme(w)},[w],s);let D=t.useCallback(()=>{var n;if(!(!S.current||!g.current)&&!V.current){z.current(g.current);let a=h||l,v=x(g.current,u||r||"",o||p||"",a||"");i.current=(n=g.current)==null?void 0:n.editor.create(S.current,{model:v,automaticLayout:!0,...R},_),E&&i.current.restoreViewState(F.get(a)),g.current.editor.setTheme(w),L!==void 0&&i.current.revealLine(L),f(!0),V.current=!0}},[r,o,l,u,p,h,R,_,E,w,L]);t.useEffect(()=>{s&&I.current(i.current,g.current)},[s]),t.useEffect(()=>{!d&&!s&&D()},[d,s,D]),e.current=u,t.useEffect(()=>{var n,a;s&&b&&((n=N.current)==null||n.dispose(),N.current=(a=i.current)==null?void 0:a.onDidChangeModelContent(v=>{k.current||b(i.current.getValue(),v)}))},[s,b]),t.useEffect(()=>{if(s){let n=g.current.editor.onDidChangeMarkers(a=>{var U;let v=(U=i.current.getModel())==null?void 0:U.uri;if(v&&a.find(O=>O.path===v.path)){let O=g.current.editor.getModelMarkers({resource:v});C==null||C(O)}});return()=>{n==null||n.dispose()}}return()=>{}},[s,C]);function K(){var n,a;(n=N.current)==null||n.dispose(),j?E&&F.set(h,i.current.saveViewState()):(a=i.current.getModel())==null||a.dispose(),i.current.dispose()}return y.createElement(Z,{width:A,height:B,isEditorReady:s,loading:H,_ref:S,className:G,wrapperProps:J})}var Me=he,we=t.memo(Me);export{we as d};
